bir linux sunucuda herhangibi bir portta kaç adet connection baglandigini görebilmek ve banlamak  için gereken komut

#!/bin/bash 

netstat -na | grep ":80" | awk '{ print $5}'| cut -d":" -f1 | sort -n | uniq -c | awk '{if($1>30){print "echo baglanti sayisi:"$1" baglanti ipsi:"$2;print "iptables -A INPUT -s " $2 " -j DROP "}}' > ban.sh

burda demek istedigimiz ayni ipden 30 connectiondan fazla baglantiyi kesmek içindir.

bu komut size ban.sh çiktisi üretir daha sonra 

sh ban.sh yazarak belirledigimiz ipleri banlar.

kolay gelsin
